<%- include ('./partials/ownerheader') %>

<% if(success.length>0){ %>
    <div class="fixed bottom-2 z-10 right-2 p-3 rounded-md bg-pink-500">
        <span class="inline-block mt-1 mb-1 text-white">
            <%= success %>
        </span>
    </div>
<% } %>

<% if(error.length>0){ %>
    <div class="fixed bottom-2 z-10 right-2 p-3 rounded-md bg-red-500">
        <span class="inline-block mt-1 mb-1 text-white">
            <%= error %>
        </span>
    </div>
<% } %>

<div x-data="{ sidebarOpen: false }" class="flex h-screen">

    <div :class="sidebarOpen ? 'block' : 'hidden'" @click="sidebarOpen = false" class="fixed inset-0 z-20 transition-opacity bg-black opacity-50 lg:hidden"></div>

    <div :class="sidebarOpen ? 'translate-x-0 ease-out' : '-translate-x-full ease-in'" class="inset-y-0 left-0 z-30 w-64 transition duration-300 transform bg-gray-900 lg:translate-x-0 lg:inset-0 absolute lg:relative h-[90%] lg:h-full">

        <div class="flex items-center justify-center mt-8">

            <div class="flex items-center">
                
                <span class="mx-2 text-2xl font-semibold text-white">Admin Dashboard</span>

            </div>

        </div>

        <nav class="mt-10">

            <a class="flex items-center px-6 py-2 mt-4 text-gray-500 hover:bg-gray-700 hover:bg-opacity-25 hover:text-gray-100" href="/owners/admin">

                <i class="ri-dashboard-fill text-2xl"></i>
                <span class="mx-3">Dashboard</span>

            </a>

            <a class="flex items-center px-6 py-2 mt-4 text-gray-100 bg-gray-700 hover:bg-opacity-25 hover:text-gray-100" href="/owners/orders">
                
                <i class="ri-shopping-cart-2-fill text-2xl"></i>
                <span class="mx-3">Orders</span>

            </a>

            <a class="flex items-center px-6 py-2 mt-4 text-gray-500 hover:bg-gray-700 hover:bg-opacity-25 hover:text-gray-100" href="/">

                <i class="ri-shopping-bag-fill text-2xl"></i>
                <span class="mx-3">Shop</span>

            </a>

            <a class="flex items-center px-6 py-2 mt-4 text-gray-500 hover:bg-gray-700 hover:bg-opacity-25 hover:text-gray-100" href="/owners/products">
                
                <i class="ri-shopping-bag-3-fill text-2xl"></i>
                <span class="mx-3">Products</span>

            </a>

            <a class="flex items-center px-6 py-2 mt-4 text-gray-500 hover:bg-gray-700 hover:bg-opacity-25 hover:text-gray-100" href="/owners/createproducts">
                
                <i class="ri-add-line text-2xl"></i>
                <span class="mx-3">Create Products</span>

            </a>

        </nav>

        <a class="flex items-center px-6 py-2 mt-4 text-white bg-red-500 absolute bottom-5 w-full" href="/users/logout">
                
                <i class="ri-arrow-right-circle-fill text-2xl"></i>
                <span class="mx-3">Logout</span>

        </a>

    </div>

    <div class="flex flex-col flex-1 overflow-hidden left-0 lg:relative w-screen">

        <header class="flex items-center justify-between px-6 py-4 bg-white border-b-4 border-pink-500">

            <div class="flex items-center">

                <button @click="sidebarOpen = true" class="text-gray-500 focus:outline-none lg:hidden">

                    <i class="ri-menu-line text-2xl"></i>

                </button>

            </div>

            <a href="/"><h1 class="text-2xl">Miss Beauty</h1></a>

            <div class="flex items-center">

                <div x-data="{ dropdownOpen: false }" class="relative">

                    <button @click="dropdownOpen = ! dropdownOpen"
                        class="relative block w-8 h-8 overflow-hidden rounded-full shadow focus:outline-none">

                        <img class="object-cover w-full h-full" src="/images/tmamu.jpg" alt="Image">

                    </button>

                    <div x-show="dropdownOpen" @click="dropdownOpen = false" class="fixed inset-0 z-10 w-full h-full"
                        style="display: none;"></div>

                    <div x-show="dropdownOpen"
                        class="absolute right-0 z-10 w-48 mt-2 overflow-hidden bg-white rounded-md shadow-xl"
                        style="display: none;">

                        <a href="/owners/admin" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-500 hover:text-white">Dashboard</a>

                        <a href="/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-500 hover:text-white">Shop</a>

                        <a href="/owners/products" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-500 hover:text-white">Products</a>

                        <a href="/owners/orders" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-500 hover:text-white">Orders</a>

                        <a href="/owners/createproducts" class="block px-4 py-2 text-sm text-gray-700 hover:bg-pink-500 hover:text-white">Create Products</a>

                        <a href="/users/logout" class="block px-4 py-2 text-sm text-white bg-red-500">Logout</a>

                    </div>

                </div>

            </div>

        </header>

        <main class="flex-1 overflow-x-hidden overflow-y-auto p-5 scroll-smooth">

            <h3 class="text-3xl font-medium text-gray-700 mt-4">Orders</h3>

            <div class="py-2 -my-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8 mt-4">

                <div class="inline-block min-w-full overflow-hidden align-middle border-b border-gray-200 shadow sm:rounded-lg">

                    <table class="min-w-full">

                        <thead>

                            <tr>

                                <th
                                    class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-left text-gray-500 uppercase border-b border-gray-200 bg-gray-50">
                                    Name</th>
                                <th
                                    class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-left text-gray-500 uppercase border-b border-gray-200 bg-gray-50">
                                    Title</th>
                                <th
                                    class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-left text-gray-500 uppercase border-b border-gray-200 bg-gray-50">
                                    Status</th>
                                <th
                                    class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-left text-gray-500 uppercase border-b border-gray-200 bg-gray-50">
                                    Price</th>
                                <th class="px-6 py-3 border-b border-gray-200 bg-gray-50"></th>
                            </tr>
                        </thead>

                        <tbody class="bg-white">

                            <% orders.forEach(order => { %>

                                    <tr>

                                        <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">

                                            <div class="flex items-center">

                                                <div class="ml-4">

                                                    <div class="text-sm font-medium leading-5 text-gray-900"><%= order.user.charAt(0).toUpperCase() + order.user.slice(1) %></div>

                                                    <div class="text-sm leading-5 text-gray-500"><%= order.order.contactNumber %></div>
                                                    
                                                </div>

                                            </div>

                                        </td>

                                        <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">

                                            <div class="text-sm leading-5 text-gray-900">
                                                <%= order.order.date.toLocaleTimeString() %>
                                            </div>

                                            <div class="text-sm leading-5 text-gray-500">
                                                <%= order.order.date.toLocaleDateString() %>
                                            </div>

                                        </td>

                                        <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">

                                            <span class="inline-flex px-2 text-xs font-semibold leading-5 text-white rounded-full 
                                            <% if (order.order.status === 'Pending') { %>
                                                bg-yellow-500
                                            <% } else if (order.order.status === 'Shipped') { %>
                                                bg-blue-500
                                            <% } else if (order.order.status === 'Delivered') { %>
                                                bg-green-500
                                            <% } else if (order.order.status === 'Cancelled') { %>
                                                bg-red-500
                                            <% } %>">
                                                <%= order.order.status %>
                                            </span>

                                        </td>

                                        <td class="px-6 py-4 text-sm leading-5 text-gray-500 whitespace-no-wrap border-b border-gray-200">
                                            Rs. <%= order.order.totalPrice %>
                                        </td>

                                        <td class="px-6 py-4 text-sm font-medium leading-5 text-right whitespace-no-wrap border-b border-gray-200">

                                            <a href="/owners/orders/<%= order.order._id %>" class="text-pink-600 hover:text-pink-900">Details</a>

                                        </td>

                                    </tr>

                            <% }) %>

                        </tbody>

                    </table>

                </div>

            </div>

        </main>

    </div>

</div>