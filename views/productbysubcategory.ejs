<%- include('./partials/header') %>

<section class="py-2">

    <h1 class="text-center text-2xl"><%= subCategory %></h1>

    <div class="p-6 flex flex-wrap items-center justify-center gap-5 relative min-h-screen">

        <% products.forEach(function(product) { %>

            <% if (product.stock > 0) { %>

                <div class="w-[300px] h-[400px] p-5 shadow-xl">
    
                    <a href="/<%= product._id %>">
            
                        <div class="relative flex items-end overflow-hidden]">
    
                            <img src="data:image/jpeg;base64,<%= product.image[0].toString('base64') %>" alt="Product Image" class="w-full h-full" style="aspect-ratio: 1/1; object-fit: contain;" />
    
                        </div>
    
                        <div class="mt-2 flex flex-col overflow-hidden">
    
                            <h2 class="text-orange-500 font-bold text-md text-center px-5 whitespace-nowrap overflow-hidden text-ellipsis"><%= product.name %></h2>
                            <% if (product.brand) { %>
                                <p class="mt-1 text-sm text-slate-400 text-center hidden">
                                    by <%= product.brand %>
                                </p>
                            <% } %>
    
                            <div class="flex flex-col items-center justify-between w-full">
    
                                <div class="flex gap-2">

                                    <p class="line-through">Rs. <%= product.price %></p>
                                    <p class="font-semibold mb-1 text-black">
                                        Rs.<%= product.price - product.discount %>
                                    </p>

                                </div>
    
                                <% if(product.stock >= 1) { %>
                                <a class="flex items-center space-x-1.5 bg-orange-500 px-4 py-1.5 w-full text-white duration-100" href="/users/addtocart/<%= product._id %>">
                                    <i class="ri-shopping-cart-line"></i>
                                    <button class="text-sm text-center">Add to cart</button>
                                </a>
    
                                <% } else { %>
                                        <a class="flex items-center space-x-1.5 bg-orange-500 px-4 py-1.5 w-full text-white duration-100 hover:bg-orange-600 cursor-not-allowed">
                                        <i class="ri-shopping-cart-line"></i>
                                        <button class="text-sm text-center">Sold Out</button>
                                    </a>
                                <% } %>
    
                            </div>
    
                        </div>
            
                    </a>
    
                </div>

            <% } %>

        <% }) %>
            
    </div>

</section>

<%- include ('./partials/footer') %>